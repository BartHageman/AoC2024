Terrible code.
abandon hope all ye who enter here
